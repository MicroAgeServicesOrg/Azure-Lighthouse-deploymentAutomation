{
    "backupJobFailedQuery": "AddonAzureBackupJobs\n| where JobOperation == \"Backup\" \n| where JobStatus == \"Failed\"\n| extend FailedJobDetails = strcat(\"Backup Item: \", BackupItemFriendlyName, \", Management Type: \", BackupManagementType, \", Time Generated: \", TimeGenerated)\n| project JobStatus, ResourceId = ResourceId, FailedJobDetails // Add ResourceId column\n| summarize Count = count(), FailedJobs = make_list(FailedJobDetails) by JobStatus, ResourceId // Include ResourceId in the grouping\n\n",
    "asrCriticalHealthQuery": "AzureDiagnostics  \r\n| extend ReplicationAgent = column_ifexists(\"replicationProviderName_s\", \"\")\r\n| extend ReplicationHealth = column_ifexists(\"replicationHealth_s\", \"\")\r\n| extend Name = column_ifexists(\"name_s\", \"\")\r\n| where ReplicationAgent in (\"InMageRcm\", \"A2A\")   \r\n| where ReplicationHealth == \"Critical\"  \r\n| where isnotempty(Name) and isnotnull(Name)   \r\n| summarize hint.strategy=partitioned arg_max(TimeGenerated, *) by Name   \r\n| summarize count()\r\n",
    "asrRPOExceeds30Query": "AzureDiagnostics\n| extend ReplicationAgent = column_ifexists(\"replicationProviderName_s\", \"\")\n| extend RPOTime = column_ifexists(\"rpoInSeconds_d\", 0)\n| where ReplicationAgent in (\"InMageRcm\", \"A2A\")\n| where RPOTime > 1800\n| summarize count()",
    "VMMemUtilizationQuery": "Perf\n| where ObjectName == \"Memory\"\n| where CounterName == \"Available Bytes\" or CounterName == \"Committed Bytes\"\n| summarize UsedBytes = sumif(CounterValue, CounterName == \"Committed Bytes\"),\n            AvailableBytes = sumif(CounterValue, CounterName == \"Available Bytes\")\n    by Computer, _ResourceId // Add _ResourceId to group by VM\n| extend MemoryUtilization = UsedBytes * 100 / (UsedBytes + AvailableBytes)\n| project Computer, MemoryUtilization, _ResourceId // Include ResourceId for reference\n\n",
    "VMFreeSpaceQuery": "Perf\n| where TimeGenerated >= ago(1m)\n| where CounterName contains \"% Free Space\"\n| join kind=inner (\n    Heartbeat\n    | where TimeGenerated >= ago(1m)\n    | where OSType == \"Windows\"\n    | project Computer\n    )\n    on Computer\n| summarize LatestValue = arg_max(TimeGenerated, CounterValue) by Computer, _ResourceId\n\n",
    "VMOfflineQuery": "Heartbeat\n| where TimeGenerated >= ago(5m)\n| summarize HeartbeatCount = count() by Computer, _ResourceId\n| join kind=leftanti (\n    AzureActivity\n    | extend ActivityStatus = column_ifexists('ActivityStatus', \"N/A\")\n    | extend Category = column_ifexists('Category', \"N/A\")\n    | extend OperationName = column_ifexists('OperationName', \"N/A\")\n    | project _ResourceId, ActivityStatus, Category, OperationName\n    | where ActivityStatus == \"Succeeded\"\n    | where Category == \"Administrative\"\n    | where OperationName == \"Deallocate Virtual Machine\"\n    | summarize by _ResourceId\n    )\n    on _ResourceId\n\n"
  }